# Description
Script [`cavs_to_rust.py`](cavs_to_rust.py) can be used to generate Rust structures with CAVS
data input vectors based on data provided by NIST (https://csrc.nist.gov/projects/cryptographic-algorithm-validation-program)

# Usage
Script provides the following options:

* "-i", "--input": Mandatory. Allows user to provide CAVS input data vectors file (*.rsp) taken from NIST. Examples: [SHA256](cavs_vectors_sha256.rsp), [AEAD GCM256 encrypt](cavs_vectors_gcm256_encrypt.rsp), [AEAD GCM256 decrypt](cavs_vectors_gcm256_decrypt.rsp).
* "-m", "--mapping": Mandatory. Allows user to provide json file with mapping between CAVS vectors file attributes ('Msg', 'MD', 'Key', 'IV', 'PT', 'AAD', 'CT', 'Tag') and Rust structure field names ('msg', 'md', 'key', 'iv', 'pt', 'aad', 'ct', 'tag') as well as types ('u32', 'Vec<u8>'). Examples: [SHA256](mapping_sha.json), [AEAD GCM256](mapping_gcm.json).
* "-f", "--filter": Optional. Allows user to provide json file with filter for CAVS vectors paramters ('Keylen', 'IVlen', 'PTlen', 'AADlen', 'Taglen'). CAVS vectors files from NIST contains multiple test cases with different configuration. Some of them may not apply for specific user's test case so this option allows to filter out all the irrelevant test cases from CAVS vectors from NIST. Example: [AEAD GCM256](filter_gcm256.json).
* "-o", "--output": Mandatory. Allows user to provide *.rs file which will be filled with Rust structures keeping CAVS vectors. Examples: [SHA256](../sha256.rs), [AEAD GCM256 encrypt](../gcm256_encrypt.rs), [AEAD GCM256 decrypt](../gcm256_decrypt.rs).

Each autogenerated file shall be formated with rust tool, e.g. "cargo fmt".

# Examples

SHA2-256
https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing#shavs
```
cd <WORKDIR>/spdm-rs/spdmlib/src/crypto/fips/cavs_vectors
wget https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/shs/shabytetestvectors.zip
unzip shabytetestvectors.zip
python3 ./scripts/cavs_to_rust.py -i shabytetestvectors/SHA256ShortMsg.rsp -m ./scripts/mapping_sha.json -o sha256_short_msg.rs
rm -rf shabytetestvectors.zip shabytetestvectors
```

SHA2-384
https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Secure-Hashing#shavs
```
cd <WORKDIR>/spdm-rs/spdmlib/src/crypto/fips/cavs_vectors
wget https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/shs/shabytetestvectors.zip
unzip shabytetestvectors.zip
python3 ./scripts/cavs_to_rust.py -i shabytetestvectors/SHA384ShortMsg.rsp -m ./scripts/mapping_sha.json -o sha384_short_msg.rs
rm -rf shabytetestvectors.zip shabytetestvectors
```

AEAD (AES-256-GCM) encryption
https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/CAVP-TESTING-BLOCK-CIPHER-MODES#GCMVS
```
cd <WORKDIR>/spdm-rs/spdmlib/src/crypto/fips/cavs_vectors
wget https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/mac/gcmtestvectors.zip
unzip gcmtestvectors.zip -d gcmtestvectors
python3 ./scripts/cavs_to_rust.py -i gcmtestvectors/gcmEncryptExtIV256.rsp -m ./scripts/mapping_gcm.json -f ./scripts/filter_gcm256.json -o gcm_encrypt_ext_iv256.rs
rm -rf gcmtestvectors.zip gcmtestvectors
```

AEAD (AES-256-GCM) decryption
https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/CAVP-TESTING-BLOCK-CIPHER-MODES#GCMVS
```
cd <WORKDIR>/spdm-rs/spdmlib/src/crypto/fips/cavs_vectors
wget https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/mac/gcmtestvectors.zip
unzip gcmtestvectors.zip -d gcmtestvectors
python3 ./scripts/cavs_to_rust.py -i gcmtestvectors/gcmDecrypt256.rsp -m ./scripts/mapping_gcm.json -f ./scripts/filter_gcm256.json -o gcm_decrypt256.rs
rm -rf gcmtestvectors.zip gcmtestvectors
```

RSA (RSASSA-PKCS#1 v1.5)
https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Digital-Signatures#rsa2vs
```
wget https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/dss/186-3rsatestvectors.zip
unzip 186-3rsatestvectors.zip -d 186-3rsatestvectors
python3 ./scripts/cavs_to_rust.py -i 186-3rsatestvectors/SigVer15_186-3.rsp -m ./scripts/mapping_rsa.json -f ./scripts/filter_rsa.json -o rsa_sig_ver.rs
rm -rf 186-3rsatestvectors.zip 186-3rsatestvectors
```

ECDSA
https://csrc.nist.gov/Projects/Cryptographic-Algorithm-Validation-Program/Digital-Signatures#ecdsa2vs
```
wget https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/dss/186-4ecdsatestvectors.zip
unzip 186-4ecdsatestvectors.zip
python3 ./scripts/cavs_to_rust.py -i 186-4ecdsatestvectors/SigVer.rsp -m ./scripts/mapping_ecdsa.json -f ./scripts/filter_ecdsa_p256_sha256.json -o ecdsa_p256_sha256_sig_ver.rs
python3 ./scripts/cavs_to_rust.py -i 186-4ecdsatestvectors/SigVer.rsp -m ./scripts/mapping_ecdsa.json -f ./scripts/filter_ecdsa_p256_sha384.json -o ecdsa_p256_sha384_sig_ver.rs
python3 ./scripts/cavs_to_rust.py -i 186-4ecdsatestvectors/SigVer.rsp -m ./scripts/mapping_ecdsa.json -f ./scripts/filter_ecdsa_p384_sha256.json -o ecdsa_p384_sha256_sig_ver.rs
python3 ./scripts/cavs_to_rust.py -i 186-4ecdsatestvectors/SigVer.rsp -m ./scripts/mapping_ecdsa.json -f ./scripts/filter_ecdsa_p384_sha384.json -o ecdsa_p384_sha384_sig_ver.rs
rm -rf 186-4ecdsatestvectors.zip 186-4ecdsatestvectors
```